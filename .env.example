# ============================================
# Vector RAG Database - Environment Configuration
# ============================================
# Copy to .env and fill in your values
# Generated: 2025-09-06

# ============================================
# REQUIRED: Core Configuration
# ============================================

# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_EMBEDDING_MODEL=text-embedding-3-large
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.7
OPENAI_REQUEST_TIMEOUT=30

# Security Keys (Generate with: openssl rand -hex 32)
FLASK_SECRET_KEY=your-flask-secret-key-minimum-32-chars
JWT_SECRET_KEY=your-jwt-secret-key-minimum-32-chars
ENCRYPTION_SECRET=your-encryption-secret-key-here
ENCRYPTION_SALT=your-base64-encoded-salt-here

# ============================================
# Application Configuration
# ============================================

# Flask Settings
FLASK_APP=app.py
FLASK_ENV=development
FLASK_DEBUG=False
FLASK_HOST=127.0.0.1
FLASK_PORT=5001

# Application Mode
APP_MODE=production  # development|production|test

# ============================================
# Vector Database Configuration
# ============================================

# ChromaDB Settings
CHROMA_PERSIST_DIRECTORY=./chroma_db
CHROMA_COLLECTION_NAME=vector_rag_collection
CHROMA_DISTANCE_METRIC=cosine
CHROMA_HNSW_M=16
CHROMA_HNSW_EF_CONSTRUCTION=200
CHROMA_HNSW_EF_SEARCH=150

# Embedding Configuration
EMBEDDING_DIMENSION=1536
EMBEDDING_BATCH_SIZE=100
EMBEDDING_CACHE_ENABLED=true
EMBEDDING_CACHE_TTL=3600

# ============================================
# Retrieval Configuration
# ============================================

# Search Settings
RETRIEVAL_TOP_K=10
RETRIEVAL_FETCH_K=20
RETRIEVAL_RERANK_TOP_K=5
RETRIEVAL_MMR_DIVERSITY=0.3
RETRIEVAL_MIN_SCORE=0.7
RETRIEVAL_USE_HYBRID=true
RETRIEVAL_LEXICAL_WEIGHT=0.3

# Chunking Configuration
CHUNK_SIZE=512
CHUNK_OVERLAP=50
CHUNK_MIN_SIZE=50
CHUNK_MAX_SIZE=1024
CHUNK_STRATEGY=hybrid  # fixed|sentence|paragraph|semantic|hybrid

# ============================================
# Ingestion Configuration
# ============================================

# Document Processing
INGEST_BATCH_SIZE=10
INGEST_MAX_FILE_SIZE_MB=100
INGEST_SUPPORTED_FORMATS=pdf,txt,md,html,docx,csv
INGEST_DEDUPE_ENABLED=true
INGEST_HASH_ALGORITHM=xxh64
INGEST_TTL_DAYS=0  # 0 = no expiry

# ============================================
# Observability Configuration
# ============================================

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json  # json|text
LOG_FILE_PATH=./logs/app.log
LOG_FILE_MAX_SIZE_MB=100
LOG_FILE_BACKUP_COUNT=5
LOG_STDOUT_ENABLED=true

# Tracing (OpenTelemetry)
OTEL_ENABLED=false
OTEL_SERVICE_NAME=vector-rag-database
OTEL_EXPORTER_ENDPOINT=http://localhost:4317
OTEL_TRACES_SAMPLER=always_on
OTEL_TRACES_SAMPLE_RATE=1.0

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# ============================================
# Performance Configuration
# ============================================

# Caching
CACHE_TYPE=redis  # redis|memory|disk
REDIS_URL=redis://localhost:6379/0
CACHE_DEFAULT_TTL=3600
CACHE_MAX_SIZE_MB=1000

# Rate Limiting
RATELIMIT_ENABLED=true
RATELIMIT_STORAGE_URL=redis://localhost:6379/1
RATELIMIT_DEFAULT=100 per hour
RATELIMIT_API_CALLS=1000 per day
RATELIMIT_STRATEGY=moving-window

# Connection Pooling
CONNECTION_POOL_SIZE=10
CONNECTION_POOL_MAX_OVERFLOW=20
CONNECTION_POOL_TIMEOUT=30

# ============================================
# Security & Compliance
# ============================================

# CORS Configuration
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization
CORS_MAX_AGE=3600

# Authentication
AUTH_ENABLED=true
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_ENABLED=true
JWT_REFRESH_EXPIRATION_DAYS=30

# Data Protection
PII_DETECTION_ENABLED=true
PII_REDACTION_ENABLED=true
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=./logs/audit.log

# ============================================
# External Services
# ============================================

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket
BACKUP_S3_REGION=us-west-2

# Notification Services
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
PAGERDUTY_INTEGRATION_KEY=your-pagerduty-key
EMAIL_SMTP_SERVER=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_FROM_ADDRESS=alerts@yourdomain.com

# ============================================
# Development/Testing
# ============================================

# Testing Configuration
TEST_MODE=false
TEST_USE_FIXTURES=true
TEST_COVERAGE_THRESHOLD=80
TEST_PARALLEL_WORKERS=4

# Development Tools
DEV_AUTO_RELOAD=true
DEV_PROFILING_ENABLED=false
DEV_SQL_ECHO=false
DEV_EXPLAIN_QUERIES=false

# ============================================
# Deployment Configuration
# ============================================

# Production Server
GUNICORN_WORKERS=4
GUNICORN_WORKER_CLASS=sync
GUNICORN_TIMEOUT=120
GUNICORN_KEEPALIVE=5
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=50
GUNICORN_BIND=0.0.0.0:8000

# Health Checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30
READINESS_CHECK_PATH=/ready
LIVENESS_CHECK_PATH=/alive

# ============================================
# Feature Flags
# ============================================

FEATURE_HYBRID_SEARCH=true
FEATURE_RERANKING=true
FEATURE_QUERY_EXPANSION=false
FEATURE_SEMANTIC_CACHE=false
FEATURE_AUTO_INDEXING=false
FEATURE_FEEDBACK_LOOP=false

# ============================================
# Notes
# ============================================
# - Never commit this file with actual secrets
# - Use strong, unique passwords for all keys
# - Rotate secrets regularly
# - Monitor rate limits to avoid service disruption
# - Adjust chunk sizes based on your content type
# - Tune HNSW parameters for your dataset size
